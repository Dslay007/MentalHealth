<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoulCare - Web Dashboard</title>
    <!-- Memuat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Font Inter dari Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Memuat ikon (untuk search, filter) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.0/lucide.min.js" rel="stylesheet" />
    <script src="https://unpkg.com/lucide-react@0.263.0/dist/umd/lucide-react.js"></script>
    
    <style>
        /* Menggunakan font Inter sebagai default */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: #f7f9ff; /* BG Biru/Ungu yang sangat muda */
            height: 100vh;
            overflow: hidden; /* Mencegah body di-scroll */
        }

        /* Konten utama yang bisa di-scroll */
        #screen-content {
            height: 100vh;
            overflow-y: auto;
            /* Padding bawah untuk memberi ruang bagi nav bar */
            padding-bottom: 120px; 
            transition: opacity 0.5s ease-in-out;
        }

        /* Scrollbar kustom */
        #screen-content::-webkit-scrollbar { width: 6px; }
        #screen-content::-webkit-scrollbar-track { background: #f1f1f1; }
        #screen-content::-webkit-scrollbar-thumb { background: #c5bbf2; border-radius: 10px; }
        #screen-content::-webkit-scrollbar-thumb:hover { background: #a092db; }

        /* Scrollbar kustom untuk Histori Jurnal */
        #journal-history-list::-webkit-scrollbar { width: 5px; }
        #journal-history-list::-webkit-scrollbar-track { background: #e9e9e9; }
        #journal-history-list::-webkit-scrollbar-thumb { background: #b0a8db; border-radius: 10px; }


        /* Style untuk Nav Bar Bawah BARU (FLOATING & RESPONSIVE) */
        #bottom-nav {
            transition: opacity 0.5s ease-in-out;
        }
        .bottom-nav-btn {
            position: relative;
            transition: all 0.2s ease-in-out;
            color: #4b5563; /* text-gray-600 */
            flex-grow: 1; /* (Mobile) Membagi rata */
        }
        .bottom-nav-btn .tooltip-text {
            visibility: hidden;
            opacity: 0;
            transition: all 0.2s ease-in-out;
            transform: translateY(5px);
        }
        .bottom-nav-btn:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
        .bottom-nav-btn:hover {
             color: #4f46e5; /* indigo-600 */
             transform: translateY(-4px);
        }
        .bottom-nav-btn.active {
            color: #4f46e5; /* indigo-600 */
            transform: translateY(-4px) scale(1.1);
        }
        .bottom-nav-btn.active .nav-icon {
            background-color: #e0e7ff; /* indigo-100 */
        }
        
        /* (Desktop) */
        @media (min-width: 768px) { 
            .bottom-nav-btn {
                flex-grow: 0; /* (Desktop) Ukuran normal */
            }
        }

        /* Halaman Welcome (Responsive FIX) */
        #page-welcome {
            transition: opacity 0.5s ease-in-out;
            min-height: 100vh; /* Mengganti h-screen */
        }


        /* Animasi untuk lingkaran pernapasan */
        @keyframes breathe {
            0%, 100% { transform: scale(0.9); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
        }
        .breathing-circle { animation: breathe 5s ease-in-out infinite; }

        /* Style untuk Custom Alert/Modal */
        #custom-alert { transition: all 0.3s ease-in-out; }

        /* Style untuk game Filter Pikiran */
        .thought-card { transition: transform 0.3s ease, opacity 0.3s ease; }

        /* Style untuk Bar Chart di Hasil Tes */
        .chart-bar {
            transition: width 1.5s ease-in-out;
            width: 0; /* Mulai dari 0 */
        }

        /* Style untuk Chat Bubbles */
        .chat-bubble {
            transition: all 0.3s ease;
        }
        #chat-messages::-webkit-scrollbar { display: none; }
        #chat-messages { -ms-overflow-style: none; scrollbar-width: none; }

        /* Transisi hover yang lebih 'playful' */
        .card-hover {
             transition: all 0.2s ease-in-out;
             position: relative; /* Diperlukan untuk SVG absolut */
             overflow: hidden; /* Mencegah SVG meluap */
        }
        .card-hover:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 20px -5px rgba(79, 70, 229, 0.15);
        }

        /* Animasi untuk toggle switch (FIXED) */
        .toggle-checkbox:checked + .toggle-label {
            background-color: #4f46e5; /* indigo-600 */
        }
        .toggle-checkbox:checked + .toggle-label .toggle-dot {
            transform: translateX(20px); /* 1.25rem */
        }

        /* Perbaikan Carousel Quote (FIXED) */
        .quote-slide {
            flex-shrink: 0;
            width: 100%;
        }
        #quote-track {
             transition: transform 0.7s ease-in-out;
        }
        
        /* Puzzle Game (BARU) */
        .puzzle-tile {
            transition: all 0.3s ease;
            background-color: #c7d2fe; /* indigo-200 */
        }
        .puzzle-tile.flipped {
            opacity: 0;
            transform: scale(0.9);
            pointer-events: none;
        }
        #puzzle-reward {
            transition: all 0.5s ease;
        }
        
        /* Animasi Shake (BARU) */
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-5px); }
          50% { transform: translateX(5px); }
          75% { transform: translateX(-5px); }
        }
        .shake-anim { animation: shake 0.5s ease-in-out; }


    </style>
</head>
<body class="min-h-screen">

    <!-- Halaman Welcome (Responsive FIX) -->
    <div id="page-welcome" onclick="enterApp()" class="flex flex-col items-center justify-center w-screen cursor-pointer bg-gradient-to-br from-indigo-50 to-purple-50 p-8 text-center min-h-screen">
        <!-- Ilustrasi Digital BARU -->
        <div class="w-full max-w-sm md:max-w-md">
            <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <path fill="#C7D2FE" d="M48.1,-63.3C61.4,-52.1,70.5,-36.3,75.1,-18.9C79.7,-1.5,80,17.4,70.7,30.3C61.5,43.2,42.8,49.9,26.4,56.7C10.1,63.5,-3.8,70.2,-19.1,68C-34.4,65.8,-51.1,54.7,-62.4,40.1C-73.7,25.6,-79.6,7.6,-77.3,-9.3C-75,-26.2,-64.5,-42,-50.9,-53.2C-37.3,-64.3,-20.6,-70.8,-3,-69.6C14.6,-68.4,29.3,-70.4,48.1,-63.3Z" transform="translate(100 100) scale(0.9)" />
                <text x="50%" y="50%" text-anchor="middle" dy=".3em" font-size="90" font-family="Inter, sans-serif" fill="#4F46E5" font-weight="bold">üßò</text>
            </svg>
        </div>
        
        <h1 class="text-3xl md:text-5xl font-bold text-gray-900 mt-8">Selamat Datang di SoulCare</h1>
        <p class="text-base md:text-xl text-gray-600 mt-4 max-w-lg">Ruang aman digitalmu untuk refleksi, tes, dan penguatan kesehatan mental.</p>
        <p class="text-lg md:text-2xl font-semibold text-indigo-600 mt-12 animate-pulse">Klik di mana saja untuk memulai</p>
    </div>


    <!-- Konten Layar Aplikasi (Bisa di-scroll) -->
    <main id="screen-content" class="relative hidden opacity-0"> 
        
        <!-- Blob Gradien Latar Belakang */ -->
        <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10">
            <div class="absolute -top-1/4 left-1/4 w-96 h-96 bg-gradient-to-r from-purple-300 to-indigo-300 rounded-full opacity-20 blur-3xl"></div>
            <div class="absolute bottom-0 right-1/4 w-80 h-80 bg-gradient-to-r from-teal-200 to-blue-200 rounded-full opacity-20 blur-3xl"></div>
        </div>

        <!-- Halaman 1: Home/Dashboard (Default) -->
        <div id="page-home" class="page p-6 md:p-12 space-y-8">
            <!-- Header Sapaan -->
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Selamat Datang, Dona!</h1>
                <p id="vibe-header" class="text-base md:text-lg text-gray-500 transition-all mt-1">Bagaimana perasaanmu hari ini?</p>
            </div>
            
            <!-- Grid Dashboard (Layout Diperbaiki - items-stretch) -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch"> <!-- Ganti items-start ke items-stretch -->
                <!-- Kolom Kiri (Aktivitas Utama) -->
                <div class="lg:col-span-2 space-y-6 flex flex-col">
                     <!-- Insight dari Soul-AI (Sesuai Gambar) -->
                    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-6 rounded-2xl shadow-lg flex items-center space-x-4 md:space-x-5 card-hover relative">
                        <div class="flex-shrink-0 z-10">
                            <!-- Icon AI (mirip gambar) -->
                            <div class="p-3 bg-white/20 rounded-xl">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"></path><path d="M12 12a10 10 0 1 0 0-20 10 10 0 0 0 0 20z"></path><path d="M12 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"></path></svg>
                            </div>
                        </div>
                        <div class="relative z-10">
                            <h3 class="font-bold text-lg md:text-xl">Insight dari Soul-AI</h3>
                            <p class="mt-1 text-sm opacity-90">Pola jurnalmu 3 hari ini menunjukkan kamu sedang fokus pada target. Hebat! Tapi, jangan lupa istirahat. Coba main "Tarik Napas" 5 menit hari ini.</p>
                        </div>
                        <div class="absolute -right-8 -bottom-8 w-32 h-32 bg-white/10 rounded-full opacity-50 z-0"></div>
                    </div>
                    
                    <!-- Quote Carousel (Estetika BARU) -->
                    <div id="quote-carousel-container" class="relative bg-gradient-to-br from-teal-50 to-blue-50 border border-teal-100 p-6 rounded-2xl shadow-lg overflow-hidden h-40 card-hover">
                        <div id="quote-track" class="absolute top-0 left-0 h-full flex">
                            <!-- Kutipan akan di-generate oleh JS -->
                        </div>
                        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2" id="quote-dots">
                            <!-- Dots akan di-generate oleh JS -->
                        </div>
                    </div>
                    
                    <!-- Tantangan Harian (BARU) -->
                    <div class="bg-cyan-50 p-6 rounded-2xl shadow-lg card-hover relative">
                        <div class="relative z-10">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Tantangan Harian</h3>
                            <div class="flex items-center space-x-4">
                                <span class="text-4xl p-3 bg-cyan-200 text-cyan-700 rounded-lg">üéØ</span>
                                <div>
                                    <p class="font-semibold text-gray-700">Tulis 3 Hal yang Kamu Syukuri</p>
                                    <p class="text-sm text-gray-500">Latih rasa syukurmu hari ini di Jurnal Harian.</p>
                                </div>
                                <button onclick="showPage('page-journal')" class="ml-auto bg-cyan-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-cyan-700 transition-all text-sm">
                                    Mulai
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Hasil Tes Terakhir (Estetika BARU) -->
                    <div class="bg-blue-50 p-6 rounded-2xl shadow-lg card-hover relative flex-1"> <!-- Tambah flex-1 -->
                        <div class="relative z-10">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Hasil Tes Terakhir</h3>
                            <p class="text-gray-500 mb-4">Ini adalah ringkasan dari tes terakhirmu. Kamu bisa mengambil tes ulang kapanpun.</p>
                            <!-- Chart dummy sederhana -->
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <span class="w-24 font-medium text-gray-600 text-sm md:text-base">Stres</span>
                                    <div class="flex-1 bg-gray-200 rounded-full h-4">
                                        <div class="bg-gradient-to-r from-red-400 to-red-600 h-4 rounded-full" style="width: 70%"></div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <span class="w-24 font-medium text-gray-600 text-sm md:text-base">Kecemasan</span>
                                    <div class="flex-1 bg-gray-200 rounded-full h-4">
                                        <div class="bg-gradient-to-r from-yellow-400 to-yellow-600 h-4 rounded-full" style="width: 40%"></div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <span class="w-24 font-medium text-gray-600 text-sm md:text-base">Depresi</span>
                                    <div class="flex-1 bg-gray-200 rounded-full h-4">
                                        <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-4 rounded-full" style="width: 25%"></div>
                                    </div>
                                </div>
                            </div>
                            <button onclick="showPage('page-result')" class="mt-5 text-sm font-semibold text-indigo-600 hover:text-indigo-800">Lihat Detail Hasil &rarr;</button>
                        </div>
                    </div>
                </div>

                <!-- Kolom Kanan (Gamifikasi - Layout Diperbaiki) -->
                <div class="lg:col-span-1 space-y-6 flex flex-col">
                    <!-- Pilihan Vibe Cepat (Estetika BARU) -->
                    <div class="bg-yellow-50 p-6 rounded-2xl shadow-lg card-hover relative">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4 relative z-10">Vibe Cepat Hari Ini</h3>
                        <div class="grid grid-cols-2 gap-3 relative z-10" id="vibe-selection">
                            <div onclick="selectVibe('Senang', this)" class="vibe-btn p-4 bg-white rounded-xl cursor-pointer hover:bg-gray-50 transition-all active:scale-95 ring-0 ring-indigo-500 flex items-center space-x-3">
                                <span class="text-2xl md:text-3xl">üòä</span>
                                <p class="font-medium text-indigo-800 text-sm md:text-base">Senang</p>
                            </div>
                            <div onclick="selectVibe('Tenang', this)" class="vibe-btn p-4 bg-white rounded-xl cursor-pointer hover:bg-gray-50 transition-all active:scale-95 ring-0 ring-blue-500 flex items-center space-x-3">
                                <span class="text-2xl md:text-3xl">üòå</span>
                                <p class="font-medium text-blue-800 text-sm md:text-base">Tenang</p>
                            </div>
                            <div onclick="selectVibe('Cemas', this)" class="vibe-btn p-4 bg-white rounded-xl cursor-pointer hover:bg-gray-50 transition-all active:scale-95 ring-0 ring-yellow-500 flex items-center space-x-3">
                                <span class="text-2xl md:text-3xl">üòü</span>
                                <p class="font-medium text-yellow-800 text-sm md:text-base">Cemas</p>
                            </div>
                            <div onclick="selectVibe('Marah', this)" class="vibe-btn p-4 bg-white rounded-xl cursor-pointer hover:bg-gray-50 transition-all active:scale-95 ring-0 ring-red-500 flex items-center space-x-3">
                                <span class="text-2xl md:text-3xl">üò†</span>
                                <p class="font-medium text-red-800 text-sm md:text-base">Marah</p>
                            </div>
                        </div>
                    </div>
                     <!-- Gamifikasi Poin (Kartu Berwarna & Simetris - flex-1 DIKEMBALIKAN) -->
                    <div class="bg-purple-50 p-6 rounded-2xl shadow-lg text-center card-hover flex-1 flex flex-col justify-center"> <!-- Tambah flex-1 -->
                        <h3 class="text-xl font-semibold text-gray-800">Poin Refleksi</h3>
                        <span id="total-points-home" class="text-5xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-indigo-600 mt-2 block">120</span>
                        <p class="text-gray-500 text-sm md:text-base">Poin didapat dari jurnal & game.</p>
                    </div>
                     <!-- Streak (Kartu Berwarna & Simetris - flex-1 DIKEMBALIKAN) -->
                    <div class="bg-orange-50 p-6 rounded-2xl shadow-lg text-center card-hover flex-1 flex flex-col justify-center"> <!-- Tambah flex-1 -->
                        <h3 class="text-xl font-semibold text-gray-800">Streak Jurnal</h3>
                        <span id="streak-count-home" class="text-5xl md:text-6xl font-extrabold text-orange-500 mt-2 block">üî• 5</span>
                        <p class="text-gray-500 text-sm md:text-base">Hari berturut-turut!</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Halaman 2: Jurnal Harian (Responsif) -->
        <div id="page-journal" class="page p-6 md:p-12 space-y-6 hidden">
            <!-- Header Halaman -->
            <div class="w-full">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Jurnal Harian</h1>
            </div>
            
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Kolom Kiri: Input Jurnal -->
                <div class="lg:w-1/2 space-y-6">
                    <!-- Pelacak Mood -->
                    <div class="bg-white p-6 rounded-2xl shadow-lg">
                        <h3 class="font-semibold text-gray-600 mb-4 text-base md:text-lg text-center">Bagaimana mood-mu untuk entri ini?</h3>
                        <div class="flex justify-around" id="mood-selection">
                            <button onclick="selectMood('üò≠', this)" class="mood-btn p-2 md:p-3 rounded-full hover:bg-red-100 transition-all active:scale-95 ring-0 ring-red-400">
                                <span class="text-3xl md:text-4xl">üò≠</span>
                            </button>
                             <button onclick="selectMood('üòü', this)" class="mood-btn p-2 md:p-3 rounded-full hover:bg-yellow-100 transition-all active:scale-95 ring-0 ring-yellow-400">
                                <span class="text-3xl md:text-4xl">üòü</span>
                            </button>
                             <button onclick="selectMood('üòå', this)" class="mood-btn p-2 md:p-3 rounded-full hover:bg-blue-100 transition-all active:scale-95 ring-0 ring-blue-400">
                                <span class="text-3xl md:text-4xl">üòå</span>
                            </button>
                             <button onclick="selectMood('üòä', this)" class="mood-btn p-2 md:p-3 rounded-full hover:bg-indigo-100 transition-all active:scale-95 ring-0 ring-indigo-400">
                                <span class="text-3xl md:text-4xl">üòä</span>
                            </button>
                            <button onclick="selectMood('ü§©', this)" class="mood-btn p-2 md:p-3 rounded-full hover:bg-green-100 transition-all active:scale-95 ring-0 ring-green-400">
                                <span class="text-3xl md:text-4xl">ü§©</span>
                            </button>
                        </div>
                    </div>
                    <!-- Kartu Pertanyaan Reflektif -->
                    <div class="bg-white p-6 rounded-2xl shadow-lg">
                        <h3 class="font-semibold text-gray-500">Pertanyaan Hari Ini:</h3>
                        <p id="journal-prompt" class="text-lg md:text-xl font-medium text-gray-900 mt-2">Apa satu hal kecil yang kamu syukuri hari ini?</p>
                    </div>
                    <!-- Text Area -->
                    <textarea id="journal-input" class="w-full h-40 p-5 text-base border border-gray-200 rounded-xl shadow-inner focus:outline-none focus:ring-2 focus:ring-indigo-400" placeholder="Tuliskan ceritamu di sini..."></textarea>
                    
                    <!-- Pengingat (FIXED) -->
                    <div class="bg-white p-5 rounded-xl shadow-lg flex justify-between items-center">
                        <h3 class="text-sm md:text-base font-semibold text-gray-700">Setel Pengingat Jurnal Harian</h3>
                        <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                            <input type="checkbox" name="toggle" id="journal-reminder" class="toggle-checkbox absolute w-full h-full opacity-0 z-10 cursor-pointer"/>
                            <label for="journal-reminder" class="toggle-label block overflow-hidden h-7 w-12 rounded-full bg-gray-300 cursor-pointer transition-colors duration-200 ease-in-out relative">
                                 <span class="toggle-dot absolute left-1 top-1 inline-block w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-200 ease-in-out"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Tombol Simpan -->
                    <button onclick="saveJournal()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-4 px-6 text-base md:text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 active:scale-95">
                        Simpan & Dapatkan 10 Poin üî•
                    </button>
                </div>
                
                <!-- Kolom Kanan: Histori Jurnal (Responsif) -->
                <div class="lg:w-1/2 bg-white p-6 rounded-2xl shadow-lg flex flex-col">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Histori Jurnal</h3>
                    <!-- Search & Filter -->
                    <div class="flex flex-col md:flex-row gap-3 mb-4">
                        <div class="relative flex-grow">
                            <input type="search" id="journal-search" onkeyup="renderJournalHistory()" class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400" placeholder="Cari di jurnal...">
                            <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        </div>
                        <select id="journal-sort" onchange="renderJournalHistory()" class="border border-gray-300 rounded-lg py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-400">
                            <option value="terbaru">Sortir: Terbaru</option>
                            <option value="terlama">Sortir: Terlama</option>
                        </select>
                    </div>
                    <!-- Daftar Histori -->
                    <div id="journal-history-list" class="flex-1 space-y-4 overflow-y-auto pr-2" style="max-height: 500px;">
                        <!-- Histori akan di-render oleh JS di sini -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Halaman 3: Pilihan Mini-Games (Responsif & BARU) -->
        <div id="page-games" class="page p-6 md:p-12 space-y-8 hidden">
            <!-- Header Halaman -->
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Permainan Reflektif</h1>
                <p class="text-base md:text-lg text-gray-500 mt-1">Latih pikiranmu dengan cara yang seru dan dapatkan poin!</p>
            </div>
            <!-- Daftar Game -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Game 1: Tarik Napas -->
                <div onclick="showPage('page-game-breathe')" class="bg-white p-6 rounded-2xl shadow-lg cursor-pointer card-hover border-4 border-transparent hover:border-blue-300 space-y-4">
                    <div class="p-4 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg w-min shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16.4 18.2c.3-.2.6-.4.8-.7a4.3 4.3 0 0 0 1.2-3.4c0-1.6-1-3-2.4-3.8"></path><path d="M12 2a4.3 4.3 0 0 0-1.2 3.4c0 1.6 1 3 2.4 3.8"></path><path d="M7.6 18.2c-.3-.2-.6-.4-.8-.7a4.3 4.3 0 0 1-1.2-3.4c0-1.6 1-3 2.4-3.8"></path><path d="M12 22a4.3 4.3 0 0 1 1.2-3.4c0-1.6-1-3-2.4-3.8"></path><path d="M2 10.3a4.3 4.3 0 0 0 1.9 3.5 4.3 4.3 0 0 0 5.2.3"></path><path d="M22 10.3a4.3 4.3 0 0 1-1.9 3.5 4.3 4.3 0 0 1-5.2.3"></path><circle cx="12" cy="12" r="2"></circle></svg>
                    </div>
                    <h4 class="text-2xl font-semibold text-gray-900">Tarik Napas</h4>
                    <p class="text-base text-gray-500">Latihan 1 menit untuk lebih tenang dan fokus.</p>
                    <span class="inline-block bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full">+5 Poin</span>
                </div>
                <!-- Game 2: Filter Pikiran -->
                <div onclick="showPage('page-game-filter')" class="bg-white p-6 rounded-2xl shadow-lg cursor-pointer card-hover border-4 border-transparent hover:border-green-300 space-y-4">
                    <div class="p-4 bg-gradient-to-br from-green-400 to-green-600 rounded-lg w-min shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 6 3 3 3-3"></path><path d="m3 12 3 3 3-3"></path><path d="m3 18 3 3 3-3"></path><line x1="12" y1="6" x2="21" y2="6"></line><line x1="12" y1="12" x2="21" y2="12"></line><line x1="12" y1="18" x2="21" y2="18"></line></svg>
                    </div>
                    <h4 class="text-2xl font-semibold text-gray-900">Filter Pikiran</h4>
                    <p class="text-base text-gray-500">Sortir pikiran yang bermanfaat & tidak bermanfaat.</p>
                    <span class="inline-block bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full">+5 Poin</span>
                </div>
                <!-- Game 3: Puzzle Syukur (SEKARANG AKTIF) -->
                <div onclick="showPage('page-game-puzzle')" class="bg-white p-6 rounded-2xl shadow-lg cursor-pointer card-hover border-4 border-transparent hover:border-purple-300 space-y-4">
                    <div class="p-4 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg w-min shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6H5a2 2 0 0 0-2 2v10"></path><path d="m21 16-4-4-4 4"></path><path d="m6 9 3-3 3 3"></path><path d="M3 11v4a2 2 0 0 0 2 2h11"></path></svg>
                    </div>
                    <h4 class="text-2xl font-semibold text-gray-900">Puzzle Syukur</h4>
                    <p class="text-base text-gray-500">Ungkap pesan syukur harian di balik puzzle.</p>
                    <span class="inline-block bg-purple-100 text-purple-800 text-sm font-medium px-3 py-1 rounded-full">+10 Poin</span>
                </div>
                <!-- Game 4: Toples Kekhawatiran (BARU) -->
                <div onclick="showPage('page-game-worry')" class="bg-white p-6 rounded-2xl shadow-lg cursor-pointer card-hover border-4 border-transparent hover:border-pink-300 space-y-4">
                    <div class="p-4 bg-gradient-to-br from-pink-400 to-pink-600 rounded-lg w-min shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 2.81v2.32c0 .5.2.98.6 1.35l4.1 3.9c.7.67 1.2 1.5.1 2.45-1.1 1-.4 2.8 1 3.4.9.4 2.1.2 3.1-.4l4.1-3.9c.4-.37.6-.85.6-1.35V2.81"/>
<path d="M7 21h10"/>
<path d="M12 21v-2.5c0-.8-.7-1.5-1.5-1.5h-1c-.8 0-1.5.7-1.5 1.5V21"/>
<path d="M6 18c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2"/>
<path d="M14 5v.5c0 .3.2.5.5.5h1c.3 0 .5-.2.5-.5V5"/></svg>
                    </div>
                    <h4 class="text-2xl font-semibold text-gray-900">Toples Kekhawatiran</h4>
                    <p class="text-base text-gray-500">Lepaskan kecemasanmu dengan menuliskannya di sini.</p>
                    <span class="inline-block bg-pink-100 text-pink-800 text-sm font-medium px-3 py-1 rounded-full">+5 Poin</span>
                </div>
                <!-- Game 5: Soundscape (BARU - COMING SOON) -->
                <div class="bg-white p-6 rounded-2xl shadow-lg transition-all opacity-60 space-y-4 border-4 border-transparent">
                    <div class="p-4 bg-gradient-to-br from-cyan-400 to-cyan-600 rounded-lg w-min shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19c-5 0-9-3.5-9-8V7c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v4c0 4.5-4 8-9 8z"/><path d="M12 11v0"/><path d="M8.5 14v0"/><path d="M15.5 14v0"/></svg>
                    </div>
                    <h4 class="text-2xl font-semibold text-gray-900">Soundscape</h4>
                    <p class="text-base text-gray-500">Dengarkan suara alam yang menenangkan pikiranmu.</p>
                    <span class="inline-block bg-gray-200 text-gray-600 text-sm font-medium px-3 py-1 rounded-full">Segera Hadir</span>
                </div>
            </div>
        </div>
        
        <!-- Halaman 4: Mini-Game Tarik Napas (Fungsional & Responsif) -->
        <div id="page-game-breathe" class="page p-6 md:p-12 hidden">
            <!-- Header Halaman -->
            <div class="flex items-center space-x-3 mb-8">
                <button onclick="stopBreatheGame(); showPage('page-games');" class="p-2 rounded-full hover:bg-gray-200 active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-600"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                </button>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Tarik Napas</h1>
            </div>
            <!-- Konten Game -->
            <div class="flex flex-col items-center justify-center h-[60vh] text-center bg-white rounded-2xl shadow-lg">
                <div class="relative w-48 h-48 md:w-64 md:h-64 flex items-center justify-center">
                    <div class="absolute w-full h-full bg-blue-200 rounded-full breathing-circle"></div>
                    <div class="absolute w-3/4 h-3/4 md:w-48 md:h-48 bg-blue-300 rounded-full breathing-circle" style="animation-delay: -0.5s;"></div>
                    <div class="absolute w-1/2 h-1/2 md:w-32 md:h-32 bg-blue-400 rounded-full breathing-circle" style="animation-delay: -1s;"></div>
                </div>
                <p id="breathe-text" class="text-2xl md:text-3xl font-semibold text-gray-800 mt-16">Siap?</p>
            </div>
        </div>

        <!-- Halaman 5: Mini-Game Filter Pikiran (Responsif) -->
        <div id="page-game-filter" class="page p-6 md:p-12 hidden">
            <!-- Header Halaman -->
            <div class="flex items-center space-x-3 mb-8">
                <button onclick="showPage('page-games');" class="p-2 rounded-full hover:bg-gray-200 active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-600"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                </button>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Filter Pikiran</h1>
            </div>
            <!-- Konten Game -->
            <div class="flex flex-col items-center justify-center h-[60vh] text-center bg-white rounded-2xl shadow-lg p-6 md:p-10">
                <p class="text-lg md:text-2xl text-gray-600">Apakah pikiran ini...</p>
                <!-- Kartu Pikiran -->
                <div id="thought-card" class="thought-card bg-gray-100 p-6 md:p-8 rounded-2xl shadow-inner w-full max-w-lg my-6 min-h-[150px] flex items-center justify-center">
                    <p id="thought-text" class="text-xl md:text-3xl font-medium text-gray-800">Saya pasti akan gagal dalam presentasi ini.</p>
                </div>
                <!-- Tombol Pilihan -->
                <div class="w-full max-w-lg flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4">
                    <button onclick="checkThought(false)" class="w-full bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold py-4 px-5 text-base md:text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95">
                        Tidak Bermanfaat
                    </button>
                    <button onclick="checkThought(true)" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold py-4 px-5 text-base md:text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95">
                        Bermanfaat
                    </button>
                </div>
                <!-- Feedback -->
                <p id="filter-feedback" class="text-lg md:text-2xl font-semibold h-10 mt-6"></p>
            </div>
        </div>

        <!-- Halaman 6: Profil (Mock) (FIXED & Estetika BARU) -->
        <div id="page-profile" class="page p-6 md:p-12 space-y-8 hidden">
             <!-- Header Halaman -->
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Profil & Pencapaian</h1>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Kolom Kiri: Info & Streak -->
                <div class="lg:col-span-1 space-y-6">
                    <div class="flex flex-col items-center space-y-3 bg-purple-50 p-8 rounded-2xl shadow-lg card-hover">
                        <img src="https://placehold.co/120x120/E9D5FF/4C1D95?text=DH" alt="Foto Profil" class="w-32 h-32 rounded-full border-4 border-purple-200 shadow-lg">
                        <h2 class="text-3xl font-semibold">Dona Haryanto</h2>
                        <p class="text-base text-gray-500">Bergabung Sejak 2025</p>
                    </div>
                    <div class="bg-orange-50 p-6 rounded-xl shadow-lg text-center card-hover">
                        <h3 class="text-xl font-semibold text-gray-800">Streak Jurnal</h3>
                        <div class="flex items-center justify-center space-x-3 mt-3">
                            <span class="text-5xl">üî•</span>
                            <span id="streak-count" class="text-5xl font-bold text-orange-500">5</span>
                            <span class="text-lg text-gray-500">hari!</span>
                        </div>
                    </div>
                    <div class="bg-indigo-50 p-6 rounded-xl shadow-lg text-center card-hover">
                        <h3 class="text-xl font-semibold text-gray-800">Total Poin Refleksi</h3>
                        <span id="total-points" class="text-5xl font-bold text-indigo-600 mt-3 block">120</span>
                    </div>
                </div>
                <!-- Kolom Kanan: Pencapaian (FIXED & Deskripsi BARU) -->
                <div class="lg:col-span-2 bg-white p-8 rounded-2xl shadow-lg card-hover">
                    <div class="relative z-10">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Lencana Pencapaian</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-6">
                            <!-- Lencana 1 -->
                            <div class="text-center p-4 bg-gray-100 rounded-lg transition-all hover:scale-105 shadow flex flex-col items-center">
                                <span class="text-6xl">üßò</span>
                                <p class="text-md font-semibold text-gray-700 mt-2">Pikiran Tenang</p>
                                <p class="text-xs text-gray-500 mt-1">Selesaikan 5x mini-game "Tarik Napas".</p>
                            </div>
                            <!-- Lencana 2 -->
                            <div class="text-center p-4 bg-gray-100 rounded-lg transition-all hover:scale-105 shadow flex flex-col items-center">
                                <span class="text-6xl">‚úçÔ∏è</span>
                                <p class="text-md font-semibold text-gray-700 mt-2">Penulis Jurnal</p>
                                <p class="text-xs text-gray-500 mt-1">Tulis jurnal 3 hari berturut-turut.</p>
                            </div>
                            <!-- Lencana 3 -->
                            <div class="text-center p-4 bg-gray-100 rounded-lg transition-all hover:scale-105 shadow flex flex-col items-center">
                                <span class="text-6xl">üß†</span>
                                <p class="text-md font-semibold text-gray-700 mt-2">Penyaring Pikiran</p>
                                <p class="text-xs text-gray-500 mt-1">Mainkan 10x "Filter Pikiran".</p>
                            </div>
                            <!-- Lencana 4 (Terkunci) -->
                            <div class="text-center p-4 bg-gray-100 rounded-lg opacity-40 transition-all hover:scale-105 shadow flex flex-col items-center">
                                <span class="text-6xl">üí™</span>
                                <p class="text-md font-semibold text-gray-700 mt-2">Mental Kuat</p>
                                <p class="text-xs text-gray-500 mt-1">Capai 7 hari streak jurnal.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
         </div>

        <!-- Halaman 7: Tes Awal (Responsif & Ilustrasi DIHAPUS) -->
        <div id="page-test" class="page p-6 md:p-12 hidden">
             <!-- Header Halaman -->
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Pusat Tes Kesehatan Mental</h1>
                <p class="text-base md:text-lg text-gray-500 mt-1">Pilih tes berdasarkan apa yang ingin kamu ketahui saat ini.</p>
            </div>
            <!-- Pilihan Kategori Tes -->
            <div id="test-categories" class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Kategori 1: Tes Stres -->
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg card-hover border-4 border-transparent hover:border-red-400 flex flex-col relative z-0">
                    <div class="p-4 bg-gradient-to-br from-red-400 to-red-600 rounded-xl w-min mb-4 shadow-lg relative z-10">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="20" x2="4" y2="8"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="20" y1="20" x2="20" y2="12"></line></svg>
                    </div>
                    <h3 class="text-2xl font-semibold text-gray-900 relative z-10">Tes Stres</h3>
                    <p class="text-gray-600 mt-2 flex-1 relative z-10">Merasa tertekan? Cek level stresmu (5 pertanyaan).</p>
                    <button onclick="startTest('stres')" class="mt-4 w-full bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold py-3 px-6 text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95 relative z-10">
                        Mulai Tes
                    </button>
                </div>
                <!-- Kategori 2: Tes Kecemasan -->
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg card-hover border-4 border-transparent hover:border-yellow-400 flex flex-col relative z-0">
                    <div class="p-4 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-xl w-min mb-4 shadow-lg relative z-10">
                         <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                    </div>
                    <h3 class="text-2xl font-semibold text-gray-900 relative z-10">Tes Kecemasan</h3>
                    <p class="text-gray-600 mt-2 flex-1 relative z-10">Sering cemas atau panik? Tes ini (5 pertanyaan) bisa membantu.</p>
                    <button onclick="startTest('cemas')" class="mt-4 w-full bg-gradient-to-r from-yellow-500 to-yellow-600 text-white font-semibold py-3 px-6 text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95 relative z-10">
                        Mulai Tes
                    </button>
                </div>
                <!-- Kategori 3: Tes Mood/Depresi -->
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg card-hover border-4 border-transparent hover:border-blue-400 flex flex-col relative z-0">
                    <div class="p-4 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl w-min mb-4 shadow-lg relative z-10">
                         <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="8" y1="15" x2="16" y2="15"></line><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>
                    </div>
                    <h3 class="text-2xl font-semibold text-gray-900 relative z-10">Tes Mood (Depresi)</h3>
                    <p class="text-gray-600 mt-2 flex-1 relative z-10">Merasa sedih belakangan ini? Cek mood-mu (5 pertanyaan).</p>
                    <button onclick="startTest('depresi')" class="mt-4 w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold py-3 px-6 text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95 relative z-10">
                        Mulai Tes
                    </button>
                </div>
            </div>
            <!-- Pertanyaan Kuis (disembunyikan) -->
            <div id="test-questions" class="mt-6 bg-white p-6 md:p-8 rounded-2xl shadow-lg max-w-2xl w-full mx-auto" style="display: none;">
                <p class="text-sm font-medium text-indigo-600 text-center" id="question-progress">Pertanyaan 1 dari 5</p>
                <h3 class="text-xl md:text-2xl font-semibold text-gray-900 mt-2 text-center" id="question-text">Saya merasa sulit untuk tenang dan rileks.</h3>
                <div class="space-y-3 mt-6 w-full mx-auto" id="question-options">
                    <!-- Opsi akan di-generate oleh JS -->
                </div>
            </div>
        </div>

        <!-- Halaman 8: Hasil Tes (Responsif) -->
         <div id="page-result" class="page p-6 md:p-12 hidden">
             <!-- Header Halaman -->
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Hasil Tes Anda</h1>
                <p class="text-base md:text-lg text-gray-500 mt-1">Berikut adalah ringkasan kondisimu selama seminggu terakhir.</p>
            </div>
            <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Kolom Kiri: Grafik -->
                <div class="lg:col-span-2 bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                    <h3 class="text-2xl font-semibold text-gray-900 mb-8">Grafik Visual Kondisi</h3>
                    <div class="space-y-6">
                        <!-- Bar Stres -->
                        <div id="chart-stres-container">
                            <span class="text-lg font-semibold text-red-700">Stres</span>
                            <div class="flex-1 bg-gray-200 rounded-full h-6 mt-2 shadow-inner">
                                <div id="chart-stres" class="chart-bar bg-gradient-to-r from-red-400 to-red-600 h-6 rounded-full flex items-center justify-end pr-3">
                                    <span class="text-sm font-bold text-white">Tinggi</span>
                                </div>
                            </div>
                        </div>
                        <!-- Bar Kecemasan -->
                        <div id="chart-cemas-container">
                            <span class="text-lg font-semibold text-yellow-700">Kecemasan</span>
                            <div class="flex-1 bg-gray-200 rounded-full h-6 mt-2 shadow-inner">
                                <div id="chart-cemas" class="chart-bar bg-gradient-to-r from-yellow-400 to-yellow-600 h-6 rounded-full flex items-center justify-end pr-3">
                                    <span class="text-sm font-bold text-white">Sedang</span>
                                </div>
                            </div>
                        </div>
                        <!-- Bar Depresi -->
                        <div id="chart-depresi-container">
                            <span class="text-lg font-semibold text-blue-700">Depresi</span>
                            <div class="flex-1 bg-gray-200 rounded-full h-6 mt-2 shadow-inner">
                                <div id="chart-depresi" class="chart-bar bg-gradient-to-r from-blue-400 to-blue-600 h-6 rounded-full flex items-center justify-end pr-3">
                                    <span class="text-sm font-bold text-white">Rendah</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Kolom Kanan: Rekomendasi AI -->
                <div class="lg:col-span-1 bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6 md:p-8 rounded-2xl shadow-2xl">
                    <h3 class="font-bold text-2xl mb-4">Rekomendasi Soul-AI</h3>
                    <div class="space-y-4 text-base opacity-90">
                        <p>Hasil tes menunjukkan level <strong class="font-bold">Stres yang cukup tinggi</strong>. Ini wajar dirasakan saat banyak tekanan.</p>
                        <p>Kami merekomendasikanmu untuk mencoba:</p>
                        <ul class="list-disc list-inside space-y-2">
                            <li><strong>Mini-Game "Tarik Napas"</strong> 2x sehari.</li>
                            <li><strong>Jurnal Harian</strong> untuk mencatat apa yang membuatmu stres.</li>
                            <li>Bicara dengan <strong>Soul-AI Chat</strong> untuk refleksi cepat.</li>
                        </ul>
                        <p class="mt-4"><strong class="font-semibold">Ingat, ini bukan diagnosis.</strong> Jika merasa sangat terganggu, jangan ragu hubungi profesional.</p>
                    </div>
                    <button onclick="showPage('page-games')" class="mt-6 w-full bg-white text-indigo-700 font-semibold py-3 px-5 text-base rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95">
                        Coba Mini-Game Sekarang
                    </button>
                </div>
            </div>
         </div>

         <!-- Halaman 9: Soul-AI Chat (Responsif) -->
        <div id="page-chat" class="page p-6 md:p-12 hidden">
            <!-- Header Halaman -->
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Soul-AI Chat</h1>
                <p class="text-base md:text-lg text-gray-500 mt-1">Teman refleksi digitalmu. Aman, anonim, dan selalu ada.</p>
            </div>
            <!-- Konten Chat -->
            <div class="mt-6 bg-white h-[65vh] rounded-2xl shadow-lg flex flex-col">
                <!-- Area Pesan -->
                <div id="chat-messages" class="flex-1 p-4 md:p-6 space-y-4 overflow-y-auto">
                    <!-- Pesan Awal AI -->
                    <div class="chat-bubble flex justify-start">
                        <div class="bg-gray-100 text-gray-800 p-3 md:p-4 rounded-t-2xl rounded-br-2xl max-w-lg">
                            <p>Halo! Aku Soul-AI. Apa yang sedang kamu pikirkan atau rasakan hari ini? Kamu bisa cerita apapun di sini.</p>
                        </div>
                    </div>
                     <!-- Pesan dummy (akan diisi JS) -->
                </div>
                <!-- Area Input Teks -->
                <div class="p-4 bg-gray-50 border-t border-gray-200 rounded-b-2xl">
                    <form id="chat-form" class="flex items-center space-x-3">
                        <input id="chat-input" type="text" placeholder="Ketik ceritamu di sini..." class="flex-1 p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-400">
                        <button type="submit" class="p-4 bg-indigo-600 text-white rounded-xl shadow-lg hover:bg-indigo-700 transition-all active:scale-95">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Halaman 10: Mini-Game Puzzle Syukur (FIXED) -->
        <div id="page-game-puzzle" class="page p-6 md:p-12 hidden">
            <!-- Header Halaman -->
            <div class="flex items-center space-x-3 mb-8">
                <button onclick="showPage('page-games');" class="p-2 rounded-full hover:bg-gray-200 active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-600"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                </button>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Puzzle Syukur</h1>
            </div>
            <!-- Konten Game -->
            <div class="flex flex-col items-center justify-center text-center bg-white rounded-2xl shadow-lg p-6 md:p-10">
                 <p class="text-lg md:text-2xl text-gray-600 mb-6">Klik kotak untuk mengungkap pesan syukur harian!</p>
                 <!-- Puzzle Grid -->
                 <div class="relative w-full max-w-md aspect-square">
                    <!-- Pesan Tersembunyi (FIXED z-index) -->
                    <div id="puzzle-reward" class="absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-br from-purple-400 to-purple-600 text-white p-8 rounded-lg opacity-0 z-10">
                        <span class="text-6xl">üéâ</span>
                        <h3 class="text-2xl font-bold mt-4">Kamu Hebat!</h3>
                        <p class="text-lg mt-2">"Perawatan diri adalah bagaimana kamu mengambil kembali kekuatanmu."</p>
                        <p class="text-lg font-semibold mt-4">+10 Poin didapatkan!</p>
                    </div>
                     <!-- Kotak Puzzle (FIXED z-index) -->
                     <div id="puzzle-grid" class="absolute inset-0 grid grid-cols-3 gap-2 z-20">
                        <!-- Tiles akan di-generate JS -->
                     </div>
                 </div>
            </div>
        </div>
        
        <!-- Halaman 11: Mini-Game Toples Kekhawatiran (BARU) -->
        <div id="page-game-worry" class="page p-6 md:p-12 hidden">
            <!-- Header Halaman -->
            <div class="flex items-center space-x-3 mb-8">
                <button onclick="showPage('page-games');" class="p-2 rounded-full hover:bg-gray-200 active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-600"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                </button>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Toples Kekhawatiran</h1>
            </div>
            <!-- Konten Game -->
            <div class="flex flex-col items-center justify-center text-center bg-white rounded-2xl shadow-lg p-6 md:p-10">
                 <p class="text-lg md:text-2xl text-gray-600 mb-6">Tulis kekhawatiranmu dan masukkan ke dalam toples untuk dilepaskan.</p>
                 
                 <!-- Ilustrasi Toples -->
                 <div class="relative my-4">
                    <svg id="worry-jar-svg" xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 24 24" fill="none" stroke="#F472B6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="opacity-30 transition-all duration-500"><path d="M8 2.81v2.32c0 .5.2.98.6 1.35l4.1 3.9c.7.67 1.2 1.5.1 2.45-1.1 1-.4 2.8 1 3.4.9.4 2.1.2 3.1-.4l4.1-3.9c.4-.37.6-.85.6-1.35V2.81"/><path d="M7 21h10"/><path d="M12 21v-2.5c0-.8-.7-1.5-1.5-1.5h-1c-.8 0-1.5.7-1.5 1.5V21"/><path d="M6 18c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2"/><path d="M14 5v.5c0 .3.2.5.5.5h1c.3 0 .5-.2.5-.5V5"/></svg>
                    <p class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-pink-600 font-bold text-4xl" id="worry-count">0</p>
                 </div>
                 <p class="text-gray-500 text-sm mb-4">Kekhawatiran di dalam toples</p>
                 
                 <!-- Input -->
                 <textarea id="worry-input" class="w-full max-w-lg h-24 p-4 text-base border border-gray-200 rounded-xl shadow-inner focus:outline-none focus:ring-2 focus:ring-pink-400" placeholder="Tulis satu kekhawatiranmu di sini..."></textarea>
                 <button onclick="saveWorry()" class="w-full max-w-lg mt-4 bg-gradient-to-r from-pink-500 to-pink-600 text-white font-semibold py-3 px-5 text-lg rounded-xl shadow-lg hover:shadow-xl hover:opacity-90 transition-all active:scale-95">
                    Masukkan ke Toples & Lepaskan
                </button>
            </div>
        </div>

    </main>

    <!-- Navigasi Bawah Horizontal (FLOATING & RESPONSIVE - FIXED) -->
    <nav id="bottom-nav" class="fixed bottom-4 z-50 bg-white/80 backdrop-blur-md shadow-xl p-3 flex justify-around items-center hidden opacity-0 
                            left-1/2 -translate-x-1/2 w-[95%] rounded-full
                            md:w-auto">
        <!-- Tombol Home -->
        <button id="nav-home-btn" onclick="showPage('page-home')" class="bottom-nav-btn p-2 flex flex-col items-center group active">
             <span class="nav-icon p-3 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
             </span>
             <span class="tooltip-text absolute -top-10 bg-gray-800 text-white text-xs font-medium px-3 py-1 rounded-md shadow-lg whitespace-nowrap hidden md:block">Home</span>
        </button>
        <!-- Tombol Tes -->
        <button id="nav-test-btn" onclick="showPage('page-test')" class="bottom-nav-btn p-2 flex flex-col items-center group">
             <span class="nav-icon p-3 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
             </span>
             <span class="tooltip-text absolute -top-10 bg-gray-800 text-white text-xs font-medium px-3 py-1 rounded-md shadow-lg whitespace-nowrap hidden md:block">Pusat Tes</span>
        </button>
        <!-- Tombol Jurnal -->
        <button id="nav-journal-btn" onclick="showPage('page-journal')" class="bottom-nav-btn p-2 flex flex-col items-center group">
             <span class="nav-icon p-3 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
             </span>
             <span class="tooltip-text absolute -top-10 bg-gray-800 text-white text-xs font-medium px-3 py-1 rounded-md shadow-lg whitespace-nowrap hidden md:block">Jurnal</span>
        </button>
        <!-- Tombol Games -->
        <button id="nav-games-btn" onclick="showPage('page-games')" class="bottom-nav-btn p-2 flex flex-col items-center group">
             <span class="nav-icon p-3 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path><path d="M12 12m-4 0a4 4 0 1 0 8 0 4 4 0 1 0-8 0"></path></svg>
             </span>
             <span class="tooltip-text absolute -top-10 bg-gray-800 text-white text-xs font-medium px-3 py-1 rounded-md shadow-lg whitespace-nowrap hidden md:block">Games</span>
        </button>
        <!-- Tombol Chat -->
        <button id="nav-chat-btn" onclick="showPage('page-chat')" class="bottom-nav-btn p-2 flex flex-col items-center group">
             <span class="nav-icon p-3 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
             </span>
             <span class="tooltip-text absolute -top-10 bg-gray-800 text-white text-xs font-medium px-3 py-1 rounded-md shadow-lg whitespace-nowrap hidden md:block">Chat AI</span>
        </button>
         <!-- Tombol Profil -->
        <button id="nav-profile-btn" onclick="showPage('page-profile')" class="bottom-nav-btn p-2 flex flex-col items-center group">
             <span class="nav-icon p-3 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
             </span>
             <span class="tooltip-text absolute -top-10 bg-gray-800 text-white text-xs font-medium px-3 py-1 rounded-md shadow-lg whitespace-nowrap hidden md:block">Profil</span>
        </button>
    </nav>


    <!-- Custom Alert/Notifikasi (pojok kanan atas) -->
    <div id="custom-alert" class="fixed top-6 right-6 max-w-sm w-full z-50 opacity-0 -translate-y-10 scale-95 pointer-events-none">
        <div class="mx-auto w-full max-w-xs bg-white rounded-xl shadow-lg border border-gray-200">
            <div class="p-4 flex items-center space-x-3">
                <div id="custom-alert-icon" class="w-10 h-10 flex-shrink-0 rounded-full bg-green-100 text-green-600 flex items-center justify-center">
                    <!-- Icon akan diisi oleh JS -->
                </div>
                <div>
                    <p id="custom-alert-message" class="text-sm font-semibold text-gray-800">Jurnal tersimpan!</p>
                </div>
            </div>
        </div>
    </div>


    <script>
        // --- DATA GLOBAL & KONTROL NAVIGASI ---
        const pages = document.querySelectorAll('.page');
        const navButtons = document.querySelectorAll('.bottom-nav-btn');
        let currentBreatheInterval = null;
        let quoteInterval = null; // Untuk quote carousel
        let currentQuoteIndex = 0;
        let userStreak = 5; 
        let userPoints = 120; // Poin gamifikasi
        let currentTestQuestion = 0;
        let testAnswers = {}; // Menyimpan jawaban tes
        let currentTestQuestions = []; // Akan diisi oleh startTest
        let currentMood = 'üòå'; // Mood default
        let puzzleTilesClicked = 0; // (BARU) Untuk puzzle
        let worryCount = 0; // (BARU) Untuk toples

        // Data dummy untuk histori jurnal (BARU)
        let journalHistoryData = [
            {
                id: 1,
                date: '2025-10-31T10:30:00',
                mood: 'üòä',
                question: "Apa satu hal kecil yang kamu syukuri hari ini?",
                answer: "Aku bersyukur bisa sarapan enak pagi ini dan cuacanya cerah banget."
            },
            {
                id: 2,
                date: '2025-10-30T21:15:00',
                mood: 'üòü',
                question: "Apa tantangan terbesar yang kamu hadapi hari ini?",
                answer: "Presentasi di depan kelas tadi bikin cemas banget, tapi untungnya semua lancar. Lega banget."
            },
            {
                id: 3,
                date: '2025-10-29T18:00:00',
                mood: 'üòå',
                question: "Siapa orang yang membuatmu tersenyum hari ini?",
                answer: "Waktu lagi suntuk, tiba-tiba teman lama chat ngajak main. Jadi senyum-senyum sendiri."
            }
        ];

        // --- FUNGSI MASUK APLIKASI (BARU) ---
        function enterApp() {
            const welcomePage = document.getElementById('page-welcome');
            const mainContent = document.getElementById('screen-content');
            const navBar = document.getElementById('bottom-nav');

            // Fade out welcome screen
            welcomePage.classList.add('opacity-0');
            
            setTimeout(() => {
                welcomePage.classList.add('hidden');
                
                // Fade in main app
                mainContent.classList.remove('hidden', 'opacity-0');
                navBar.classList.remove('hidden', 'opacity-0');
                mainContent.classList.add('opacity-100');
                navBar.classList.add('opacity-100');
                
                // Show the home page
                showPage('page-home');
            }, 500); // Tunggu transisi fade-out selesai
        }


        // --- KONTROL HALAMAN (GANTI SISTEM KE PAGE, BUKAN MODAL) ---
        function showPage(pageId) {
            // Sembunyikan semua halaman
            pages.forEach(page => { page.classList.add('hidden'); });
            
            // Tampilkan halaman yang dituju
            const targetPage = document.getElementById(pageId);
            if (targetPage) { 
                targetPage.classList.remove('hidden'); 
            }

            // Hentikan interval spesifik halaman
            stopBreatheGame();
            stopQuoteCarousel();

            // Set status aktif untuk tombol navigasi
            navButtons.forEach(btn => {
                const btnPageId = 'page-' + btn.id.replace('-btn', '').replace('nav-', '');
                
                let isGamePage = (pageId === 'page-game-breathe' || pageId === 'page-game-filter' || pageId === 'page-game-puzzle' || pageId === 'page-game-worry'); // (UPDATE)
                let isTestPage = (pageId === 'page-result');

                if (btnPageId === pageId || 
                   (isGamePage && btnPageId === 'page-games') ||
                   (isTestPage && btnPageId === 'page-test')) 
                {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // Logika spesifik per halaman
            if (pageId === 'page-home') {
                updateDashboard();
                startQuoteCarousel(); // Mulai carousel
            }
            if (pageId === 'page-journal') {
                loadJournalPrompt();
                renderJournalHistory(); // (BARU) Render histori saat buka jurnal
            }
            if (pageId === 'page-game-breathe') {
                startBreatheGame();
            }
            if (pageId === 'page-game-filter') {
                loadThought(); 
            }
            if (pageId === 'page-game-puzzle') { // (BARU)
                initPuzzle();
            }
            if (pageId === 'page-game-worry') { // (BARU)
                document.getElementById('worry-count').textContent = worryCount;
            }
            if (pageId === 'page-profile') {
                updateProfile();
            }
            if (pageId === 'page-result') {
                animateChart(); // Animasikan chart saat halaman hasil dibuka
            }
             if (pageId === 'page-test') {
                // Tampilkan pilihan paket, sembunyikan pertanyaan
                document.getElementById('test-categories').style.display = 'grid';
                document.getElementById('test-questions').style.display = 'none';
            }

            // Selalu scroll ke atas saat ganti halaman
            document.getElementById('screen-content').scrollTop = 0;
        }

        function updateDashboard() {
            document.getElementById('streak-count-home').innerHTML = `üî• ${userStreak}`;
            document.getElementById('total-points-home').textContent = userPoints;
        }

        // --- LOGIKA JURNAL & HISTORI (BARU) ---
        const journalPrompts = [
            "Apa satu hal kecil yang kamu syukuri hari ini?",
            "Siapa orang yang membuatmu tersenyum hari ini?",
            "Apa tantangan terbesar yang kamu hadapi hari ini dan bagaimana kamu mengatasinya?",
            "Tuliskan 3 hal yang kamu sukai dari dirimu sendiri.",
            "Bagaimana perasaanmu saat ini? Coba deskripsikan dengan jujur."
        ];

        function loadJournalPrompt() {
            document.getElementById('journal-input').value = ""; // Kosongkan input
            const promptElement = document.getElementById('journal-prompt');
            const randomIndex = Math.floor(Math.random() * journalPrompts.length);
            promptElement.textContent = journalPrompts[randomIndex];
            currentMood = 'üòå'; // Reset mood
            // Reset mood selection
            document.querySelectorAll('#mood-selection .mood-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-red-400', 'ring-yellow-400', 'ring-blue-400', 'ring-indigo-400', 'ring-green-400');
                if(btn.innerText.includes(currentMood)) { // Pilih mood default
                     btn.classList.add('ring-2', 'ring-blue-400');
                }
            });
        }

        function saveJournal() {
            const answer = document.getElementById('journal-input').value;
            const question = document.getElementById('journal-prompt').textContent;
            if(answer.trim() === "") {
                showCustomAlert("Jurnal tidak boleh kosong!", "error");
                return;
            }

            // Buat entri baru
            const newEntry = {
                id: Date.now(),
                date: new Date().toISOString(),
                mood: currentMood,
                question: question,
                answer: answer
            };
            
            // Tambahkan ke data (di awal array)
            journalHistoryData.unshift(newEntry);

            userStreak++; 
            userPoints += 10; // Tambah poin
            showCustomAlert("Jurnal tersimpan! +10 Poin üî•", "success");
            
            // Reset input & render ulang histori
            loadJournalPrompt();
            renderJournalHistory();
            
            // Pindah ke home setelah 1.5 detik
            setTimeout(() => {
                showPage('page-home');
            }, 1500);
        }

         // --- LOGIKA MOOD JURNAL ---
        function selectMood(mood, element) {
            currentMood = mood; // Simpan mood
            // Reset semua tombol
            const buttons = document.querySelectorAll('#mood-selection .mood-btn');
            buttons.forEach(btn => {
                btn.classList.remove('ring-2');
                btn.classList.remove('ring-red-400', 'ring-yellow-400', 'ring-blue-400', 'ring-indigo-400', 'ring-green-400');
            });
            
            // Set tombol yang aktif
            element.classList.add('ring-2');
            if (mood.includes('üò≠')) element.classList.add('ring-red-400');
            else if (mood.includes('üòü')) element.classList.add('ring-yellow-400');
            else if (mood.includes('üòå')) element.classList.add('ring-blue-400');
            else if (mood.includes('üòä')) element.classList.add('ring-indigo-400');
            else if (mood.includes('ü§©')) element.classList.add('ring-green-400');
        }
        
        // --- RENDER HISTORI JURNAL (BARU) ---
        function renderJournalHistory() {
            const listContainer = document.getElementById('journal-history-list');
            const searchTerm = document.getElementById('journal-search').value.toLowerCase();
            const sortOrder = document.getElementById('journal-sort').value;
            
            listContainer.innerHTML = ''; // Kosongkan list

            // 1. Filter data
            let filteredData = journalHistoryData.filter(entry => 
                entry.question.toLowerCase().includes(searchTerm) ||
                entry.answer.toLowerCase().includes(searchTerm)
            );

            // 2. Sort data
            filteredData.sort((a, b) => {
                if (sortOrder === 'terbaru') {
                    return new Date(b.date) - new Date(a.date);
                } else {
                    return new Date(a.date) - new Date(b.date);
                }
            });

            // 3. Render HTML
            if (filteredData.length === 0) {
                 listContainer.innerHTML = `<p class="text-gray-500 text-center mt-4">Tidak ada jurnal ditemukan.</p>`;
                 return;
            }
            
            filteredData.forEach(entry => {
                const entryDate = new Date(entry.date);
                const dateString = entryDate.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });
                const timeString = entryDate.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });

                const entryHtml = `
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-2xl">${entry.mood}</span>
                            <span class="text-sm font-medium text-gray-500">${dateString} - ${timeString}</span>
                        </div>
                        <p class="font-semibold text-gray-700 text-sm mb-1">Pertanyaan: ${entry.question}</p>
                        <p class="text-gray-600 text-sm truncate">${entry.answer}</p>
                    </div>
                `;
                listContainer.innerHTML += entryHtml;
            });
        }

        // --- LOGIKA "VIBE CEPAT" ---
        function selectVibe(vibe, element) {
            const header = document.getElementById('vibe-header');
            header.textContent = `Oke, kamu merasa ${vibe} hari ini. Tercatat!`;
            
            const buttons = document.querySelectorAll('#vibe-selection .vibe-btn');
            buttons.forEach(btn => {
                btn.classList.remove('ring-2');
                btn.classList.remove('ring-indigo-500', 'ring-blue-500', 'ring-yellow-500', 'ring-red-500');
            });

            element.classList.add('ring-2');
            if (vibe === 'Senang') element.classList.add('ring-indigo-500');
            if (vibe === 'Tenang') element.classList.add('ring-blue-500');
            if (vibe === 'Cemas') element.classList.add('ring-yellow-500');
            if (vibe === 'Marah') element.classList.add('ring-red-500');
        }

        // --- LOGIKA GAME PERNAPASAN ---
        const breatheText = document.getElementById('breathe-text');
        const breatheSteps = ["Tarik Napas...", "Tahan...", "Hembuskan..."];
        let currentBreatheStep = 0;

        function startBreatheGame() {
            if (currentBreatheInterval) return; 
            function nextStep() {
                if(breatheText) breatheText.textContent = breatheSteps[currentBreatheStep];
                currentBreatheStep = (currentBreatheStep + 1) % breatheSteps.length;
            }
            nextStep();
            currentBreatheInterval = setInterval(nextStep, 3500); 
        }

        function stopBreatheGame() {
            clearInterval(currentBreatheInterval);
            currentBreatheInterval = null;
            if(breatheText) breatheText.textContent = "Siap?";
            currentBreatheStep = 0;
        }

        // --- LOGIKA GAME FILTER PIKIRAN ---
        const thoughts = [
            { text: "Saya pasti akan gagal dalam presentasi ini.", isHelpful: false },
            { text: "Saya sudah berlatih, saya akan lakukan yang terbaik.", isHelpful: true },
            { text: "Semua orang menertawakan saya.", isHelpful: false },
            { text: "Saya bisa belajar dari kesalahan jika itu terjadi.", isHelpful: true },
            { text: "Ini terlalu sulit, saya menyerah.", isHelpful: false }
        ];
        let currentThoughtIndex = 0;
        
        function loadThought() {
            const thoughtCard = document.querySelector('#page-game-filter #thought-card');
            const thoughtText = document.querySelector('#page-game-filter #thought-text');
            const filterFeedback = document.querySelector('#page-game-filter #filter-feedback');

            if (currentThoughtIndex >= thoughts.length) {
                currentThoughtIndex = 0; 
            }
            if (!thoughtCard) return; // Guard clause
            
            thoughtCard.style.opacity = '0';
            thoughtCard.style.transform = 'scale(0.9)';
            setTimeout(() => {
                thoughtText.textContent = thoughts[currentThoughtIndex].text;
                filterFeedback.textContent = ""; 
                filterFeedback.classList.remove('text-green-600', 'text-red-600');
                thoughtCard.style.opacity = '1';
                thoughtCard.style.transform = 'scale(1)';
            }, 300);
        }

        function checkThought(userChoice) {
            const filterFeedback = document.querySelector('#page-game-filter #filter-feedback');
            const correctChoice = thoughts[currentThoughtIndex].isHelpful;
            if (userChoice === correctChoice) {
                filterFeedback.textContent = "Tepat Sekali! +5 Poin";
                filterFeedback.classList.add('text-green-600');
                userPoints += 5; // Tambah poin
            } else {
                filterFeedback.textContent = "Coba lagi!";
                filterFeedback.classList.remove('text-green-600'); 
                filterFeedback.classList.add('text-red-600');
            }
            currentThoughtIndex++; 
            setTimeout(loadThought, 1500);
        }
        
        // --- LOGIKA GAME PUZZLE (FIXED) ---
        function initPuzzle() {
            const grid = document.getElementById('puzzle-grid');
            const reward = document.getElementById('puzzle-reward');
            if (!grid || !reward) return;
            
            grid.innerHTML = ''; // Kosongkan grid
            puzzleTilesClicked = 0;
            
            // Sembunyikan reward, pastikan grid terlihat
            reward.classList.add('opacity-0', 'z-10');
            reward.classList.remove('opacity-100', 'z-30');
            grid.classList.add('z-20');
            grid.classList.remove('opacity-0');

            // Buat 9 tiles
            for (let i = 0; i < 9; i++) {
                const tile = document.createElement('button');
                tile.className = 'puzzle-tile w-full aspect-square rounded-lg shadow-md hover:bg-indigo-300 active:scale-95';
                tile.dataset.index = i;
                
                tile.onclick = () => {
                    if (tile.classList.contains('flipped')) return;
                    
                    tile.classList.add('flipped');
                    puzzleTilesClicked++;
                    
                    if (puzzleTilesClicked === 9) {
                        // Tampilkan reward
                        setTimeout(() => {
                            grid.classList.add('opacity-0'); // Sembunyikan grid
                            grid.classList.remove('z-20');
                            reward.classList.remove('opacity-0', 'z-10');
                            reward.classList.add('opacity-100', 'z-30'); // Tampilkan reward
                            userPoints += 10;
                            showCustomAlert("Puzzle Selesai! +10 Poin üß©", "success");
                        }, 300);
                    }
                };
                grid.appendChild(tile);
            }
        }
        
        // --- LOGIKA GAME WORRY JAR (ANIMATED) ---
        function saveWorry() {
            const input = document.getElementById('worry-input');
            const countSpan = document.getElementById('worry-count');
            const jarIcon = document.getElementById('worry-jar-svg');
            
            if (input.value.trim() === "") {
                showCustomAlert("Tulis kekhawatiranmu dulu", "error");
                return;
            }
            
            worryCount++;
            userPoints += 5;
            countSpan.textContent = worryCount;
            input.value = "";
            
            // Animasi & Feedback
            showCustomAlert("Kekhawatiran dilepaskan! +5 Poin üè∫", "success");
            jarIcon.classList.add('shake-anim');
            setTimeout(() => {
                jarIcon.classList.remove('shake-anim');
            }, 500);
        }


        // --- LOGIKA PROFIL ---
        function updateProfile() {
            document.querySelector('#page-profile #streak-count').textContent = userStreak;
            document.querySelector('#page-profile #total-points').textContent = userPoints;
        }
        
        // --- LOGIKA TES AWAL (DIRUBAH PER KATEGORI) ---
        const allTestQuestions = {
            stres: [
                { q: "Saya merasa sulit untuk tenang dan rileks.", category: 'stres' },
                { q: "Saya mudah marah atau tersinggung.", category: 'stres' },
                { q: "Saya merasa terlalu terbebani oleh pekerjaan atau tugas.", category: 'stres' },
                { q: "Saya merasa tegang atau gelisah.", category: 'stres' },
                { q: "Saya sulit berkonsentrasi karena terlalu banyak pikiran.", category: 'stres' }
            ],
            cemas: [
                { q: "Saya merasa cemas berlebihan tentang banyak hal.", category: 'cemas' },
                { q: "Saya merasa panik atau takut secara tiba-tiba.", category: 'cemas' },
                { q: "Saya tidak bisa berhenti khawatir.", category: 'cemas' },
                { q: "Saya merasa gelisah dan tidak bisa diam.", category: 'cemas' },
                { q: "Saya takut hal buruk akan terjadi.", category: 'cemas' }
            ],
            depresi: [
                { q: "Saya merasa sedih dan murung hampir sepanjang waktu.", category: 'depresi' },
                { q: "Saya kehilangan minat pada hal-hal yang biasanya saya nikmati.", category: 'depresi' },
                { q: "Saya merasa lelah tanpa alasan yang jelas.", category: 'depresi' },
                { q: "Saya merasa tidak berharga atau bersalah.", category: 'depresi' },
                { q: "Saya kesulitan tidur atau tidur terlalu banyak.", category: 'depresi' }
            ]
        };
        const testOptions = ["Tidak Pernah", "Jarang", "Sering", "Hampir Selalu"];

        function startTest(testType) { // 'stres', 'cemas', or 'depresi'
            currentTestQuestions = allTestQuestions[testType]; // Pilih set pertanyaan
            currentTestQuestion = 0;
            testAnswers = { stres: 0, cemas: 0, depresi: 0 }; // Reset skor
            document.getElementById('test-categories').style.display = 'none'; // Sembunyikan paket
            document.getElementById('test-questions').style.display = 'block'; // Tampilkan pertanyaan
            
            loadTestQuestion();
        }

        function loadTestQuestion() {
            const question = currentTestQuestions[currentTestQuestion];
            document.querySelector('#page-test #question-progress').textContent = `Pertanyaan ${currentTestQuestion + 1} dari ${currentTestQuestions.length}`;
            document.querySelector('#page-test #question-text').textContent = question.q;

            const optionsContainer = document.querySelector('#page-test #question-options');
            optionsContainer.innerHTML = '';
            testOptions.forEach((option, index) => {
                optionsContainer.innerHTML += `
                    <button onclick="answerQuestion(${index}, '${question.category}')" class="w-full text-left p-4 border border-gray-200 rounded-lg hover:bg-indigo-50 hover:border-indigo-400 transition-all active:scale-95">
                        ${option}
                    </button>
                `;
            });
        }

        function answerQuestion(score, category) {
            testAnswers[category] += score; // Tambah skor berdasarkan kategori
            currentTestQuestion++;
            if (currentTestQuestion < currentTestQuestions.length) {
                loadTestQuestion();
            } else {
                finishTest();
            }
        }

        function finishTest() {
            userPoints += 20; // Poin karena menyelesaikan tes
            showCustomAlert("Tes Selesai! +20 Poin üß†", "success");
            
            // Sembunyikan pertanyaan, tampilkan lagi paket tes
            document.getElementById('test-questions').style.display = 'none';
            document.getElementById('test-categories').style.display = 'grid';
            
            // Pindah ke halaman hasil
            setTimeout(() => {
                showPage('page-result');
            }, 1500);
        }

        // --- LOGIKA HASIL TES ---
        function animateChart() {
            const maxStres = (allTestQuestions.stres.length * 3);
            const maxCemas = (allTestQuestions.cemas.length * 3);
            const maxDepresi = (allTestQuestions.depresi.length * 3);
            
            let stresScore = (testAnswers.stres / maxStres) * 100 || 0;
            let cemasScore = (testAnswers.cemas / maxCemas) * 100 || 0;
            let depresiScore = (testAnswers.depresi / maxDepresi) * 100 || 0;

            const chartStresContainer = document.querySelector('#page-result #chart-stres-container');
            const chartCemasContainer = document.querySelector('#page-result #chart-cemas-container');
            const chartDepresiContainer = document.querySelector('#page-result #chart-depresi-container');

            // Jika belum tes (skor 0 semua), beri nilai default
            if (stresScore === 0 && cemasScore === 0 && depresiScore === 0) {
                stresScore = 70; cemasScore = 40; depresiScore = 25; // Default lama
                chartStresContainer.style.display = 'block';
                chartCemasContainer.style.display = 'block';
                chartDepresiContainer.style.display = 'block';
            } else {
                // Sembunyikan bar yang tidak relevan (skor 0)
                chartStresContainer.style.display = stresScore > 0 ? 'block' : 'none';
                chartCemasContainer.style.display = cemasScore > 0 ? 'block' : 'none';
                chartDepresiContainer.style.display = depresiScore > 0 ? 'block' : 'none';
            }
            
            // Set width ke 0 dulu untuk memicu transisi
            document.querySelector('#page-result #chart-stres').style.width = `0%`;
            document.querySelector('#page-result #chart-cemas').style.width = `0%`;
            document.querySelector('#page-result #chart-depresi').style.width = `0%`;

            // Set width baru setelah delay singkat
            setTimeout(() => {
                document.querySelector('#page-result #chart-stres').style.width = `${stresScore}%`;
                document.querySelector('#page-result #chart-cemas').style.width = `${cemasScore}%`;
                document.querySelector('#page-result #chart-depresi').style.width = `${depresiScore}%`;
            }, 100);
        }
        
        // --- LOGIKA AI CHAT ---
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatMessages = document.getElementById('chat-messages');

        const aiResponses = [
            "Itu terdengar wajar untuk dirasakan. Bisa ceritakan lebih lanjut?",
            "Terima kasih sudah berbagi. Mengakui perasaan itu adalah langkah pertama.",
            "Bagaimana perasaanmu saat hal itu terjadi?",
            "Itu pasti sulit. Apa yang biasanya kamu lakukan untuk merasa lebih baik?",
            "Aku mengerti. Coba kita tarik napas sejenak. Tarik... Hembuskan..."
        ];

        chatForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const messageText = chatInput.value.trim();
            if (messageText === "") return;

            // 1. Tampilkan pesan user
            const userBubble = document.createElement('div');
            userBubble.className = "chat-bubble flex justify-end";
            userBubble.innerHTML = `
                <div class="bg-indigo-600 text-white p-3 md:p-4 rounded-t-2xl rounded-bl-2xl max-w-lg">
                    <p>${messageText}</p>
                </div>
            `;
            chatMessages.appendChild(userBubble);
            
            chatInput.value = ""; // Kosongkan input
            chatMessages.scrollTop = chatMessages.scrollHeight; // Auto-scroll

            // 2. Tampilkan "typing..."
            const typingBubble = document.createElement('div');
            typingBubble.className = "chat-bubble flex justify-start";
            typingBubble.id = "typing-indicator";
            typingBubble.innerHTML = `
                <div class="bg-gray-100 text-gray-800 p-3 md:p-4 rounded-t-2xl rounded-br-2xl max-w-lg">
                    <p class="italic">Soul-AI sedang mengetik...</p>
                </div>
            `;
            chatMessages.appendChild(typingBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // 3. Tampilkan jawaban AI (dummy)
            setTimeout(() => {
                const aiBubble = document.createElement('div');
                aiBubble.className = "chat-bubble flex justify-start";
                const randomResponse = aiResponses[Math.floor(Math.random() * aiResponses.length)];
                aiBubble.innerHTML = `
                    <div class="bg-gray-100 text-gray-800 p-3 md:p-4 rounded-t-2xl rounded-br-2xl max-w-lg">
                        <p>${randomResponse}</p>
                    </div>
                `;
                // Ganti "typing..." dengan jawaban
                chatMessages.replaceChild(aiBubble, typingBubble);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1500 + Math.random() * 1000);
        });


        // --- LOGIKA CUSTOM ALERT ---
        function showCustomAlert(message, type = 'success') {
            const alertBox = document.getElementById('custom-alert');
            const alertMessage = document.getElementById('custom-alert-message');
            const alertIcon = document.getElementById('custom-alert-icon');

            alertMessage.textContent = message;

            if (type === 'success') {
                alertIcon.innerHTML = '<span>üéâ</span>'; 
                alertIcon.className = 'w-10 h-10 flex-shrink-0 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xl';
            } else {
                alertIcon.innerHTML = '<span>!</span>';
                alertIcon.className = 'w-10 h-10 flex-shrink-0 rounded-full bg-red-100 text-red-600 flex items-center justify-center text-xl';
            }

            alertBox.classList.remove('opacity-0', '-translate-y-10', 'scale-95');
            alertBox.classList.add('opacity-100', 'translate-y-0', 'scale-100');

            setTimeout(() => {
                alertBox.classList.add('opacity-0', '-translate-Y-10', 'scale-95');
                alertBox.classList.remove('opacity-100', 'translate-y-0', 'scale-100');
            }, 3000);
        }

         // --- LOGIKA QUOTE CAROUSEL (DIKEMBALIKAN & DIPERBAIKI) ---
        const quotes = [
            { text: "Kesehatan mental... bukanlah tujuan, tapi sebuah proses. Ini tentang bagaimana kamu berkendara, bukan ke mana kamu pergi.", author: "Noam Shpancer" },
            { text: "Kamu tidak harus mengendalikan pikiranmu. Kamu hanya harus berhenti membiarkan mereka mengendalikanmu.", author: "Dan Millman" },
            { text: "Perawatan diri adalah bagaimana kamu mengambil kembali kekuatanmu.", author: "Lalah Delia" },
            { text: "Tidak apa-apa untuk tidak baik-baik saja.", author: "Anonim" }
        ];

        function stopQuoteCarousel() {
            clearInterval(quoteInterval);
            quoteInterval = null;
        }

        function startQuoteCarousel() {
            if (quoteInterval) return; // Mencegah interval ganda

            const track = document.getElementById('quote-track');
            const dotsContainer = document.getElementById('quote-dots');
            if (!track || !dotsContainer) return; // Pastikan elemen ada
            track.innerHTML = '';
            dotsContainer.innerHTML = '';
            
            // (FIXED) Set width track berdasarkan jumlah quote
            track.style.width = `${quotes.length * 100}%`; 

            // Buat slides dan dots
            quotes.forEach((quote, index) => {
                // Buat slide (FIXED: width berdasarkan % track)
                const slide = document.createElement('div');
                slide.className = "quote-slide p-6 flex flex-col justify-center items-center text-center h-full";
                slide.style.width = `${100 / quotes.length}%`; // FIXED
                slide.innerHTML = `
                    <p class="text-base md:text-lg font-medium text-gray-700">"${quote.text}"</p>
                    <p class="text-sm font-semibold text-teal-600 mt-3">- ${quote.author}</p>
                `;
                track.appendChild(slide);

                // Buat dot
                const dot = document.createElement('button');
                dot.className = "h-2 w-2 rounded-full bg-gray-300 transition-all";
                dot.onclick = () => {
                    currentQuoteIndex = index;
                    updateCarousel();
                };
                dotsContainer.appendChild(dot);
            });

            // Fungsi untuk update tampilan carousel
            function updateCarousel() {
                // (FIXED) Geser track
                track.style.transform = `translateX(-${currentQuoteIndex * (100 / quotes.length)}%)`;

                const allDots = dotsContainer.querySelectorAll('button');
                allDots.forEach((dot, index) => {
                    if (index === currentQuoteIndex) {
                        dot.classList.remove('bg-gray-300');
                        dot.classList.add('bg-teal-600'); // (Estetika BARU)
                    } else {
                        dot.classList.add('bg-gray-300');
                        dot.classList.remove('bg-teal-600');
                    }
                });
            }

            // Mulai interval
            quoteInterval = setInterval(() => {
                currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
                updateCarousel();
            }, 5000); // Ganti setiap 5 detik

            updateCarousel(); // Tampilkan slide pertama
        }


        // Inisialisasi: Tampilkan halaman home saat pertama kali dimuat
        document.addEventListener('DOMContentLoaded', () => {
            // Tidak memanggil showPage('page-home') lagi,
            // Cukup biarkan #page-welcome tampil secara default
        });
    </script>

</body>
</html>

